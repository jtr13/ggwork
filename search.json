[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "TITLE",
    "section": "",
    "text": "Introduction",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "timeseries.html",
    "href": "timeseries.html",
    "title": "1  Time Series",
    "section": "",
    "text": "library(tidyverse)\nlibrary(packageRank)\n\ntop_packages &lt;- c(\"ggrepel\", \"cowplot\",\"ggpubr\", \"ggsci\", \"ggsignif\", \"patchwork\", \"ggmap\")\n\ntime_series &lt;- function(pkg) {\n  cranDownloads(packages = pkg, to = 2025)$cranlogs.data\n}\n\nallpackages &lt;- map_dfr(top_packages, time_series)\n\n\nggplot(allpackages, aes(x = date, y = count, color = package)) + \n  geom_smooth(se = FALSE, linewidth = .75)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Time Series</span>"
    ]
  },
  {
    "objectID": "tidyverse_gallery_scrape.html",
    "href": "tidyverse_gallery_scrape.html",
    "title": "2  Tidyverse Gallery Scrape",
    "section": "",
    "text": "The following code is designed to scrape the names of packages in the ggplot environment from the tidyverse gallery (https://exts.ggplot2.tidyverse.org/gallery/) and then retrieve the cumulative historical cran download count for each. It also scrapes the github star count listed for these packages.\nFirst import the necessary packages:\n\nlibrary(tidyverse)\nlibrary(rvest) #html webscraping\nlibrary(packageRank) #to retrieve CRAN download counts\n\nRead in the downloaded tidyverse gallery page html file. Must download webpage for the github star scrape to work properly.\n\ndf &lt;- read_html(\"raw_data/exts.ggplot2.tidyverse.org.html\")\n\nError in `path_to_connection()`:\n! 'raw_data/exts.ggplot2.tidyverse.org.html' does not exist in current\n  working directory ('/home/runner/work/ggwork/ggwork').\n\n\nScrape the package names and store in a package_names vector.\n\npackage_names &lt;- df |&gt;\n  html_elements(\"div.card-content\") |&gt; \n  html_elements(\"span.card-title\") |&gt; \n  html_text()\n\nError in UseMethod(\"xml_find_all\"): no applicable method for 'xml_find_all' applied to an object of class \"function\"\n\n\nThe below function get_total_downloads takes in a package name and a date parameter to retrieve a cumulative count of that package’s cran downloads up until that date by utilizing the cranDownloads function of packageRank.\n\nget_total_downloads &lt;- function(pkg, date) {\n  #to = 2025 pulls entire download history\n  cd &lt;- cranDownloads(packages = pkg, to = 2025) \n  \n  #retrieving the 'cumulative' value of a particular date gets total download    count up to that date\n  cd$cranlogs.data$cumulative [ \n    cd$cranlogs.data$date == date \n  ]\n}\n\nTo find the most current total historical download count, set a target_date of two days before today. Depending on the time of day, cranDownloads is updated to either 1 or 2 days previous to the current day.\n\ntarget_date &lt;- Sys.Date()-2\n\nRetrieve cran download count for each package by looping across package_names and store in a new vector called downloads_count. Directly passing in a package_names vector into cranDownloads function does not work properly. Will take a few minutes to complete.\n\ndownloads_count &lt;- numeric(length(package_names))\n\nError: object 'package_names' not found\n\n#cranDownloads sometimes will throw an error that terminates the loop if not handled properly\nfor (i in seq_along(package_names)) {\n  dc &lt;- tryCatch(\n    get_total_downloads(package_names[i], target_date),\n    \n    #if the package is not found in cran return NA\n    error = function(e) NA\n  )\n  downloads_count[i] &lt;- ifelse(length(dc) == 0, NA, dc)\n}\n\nError: object 'package_names' not found\n\n\nScrape github star count from the gallery webpage.\n\ngithub_stars &lt;- df |&gt; \n  html_elements(\"span.github-btn\") |&gt;\n  html_elements(\"a.gh-count\") |&gt; \n  html_text() |&gt; as.numeric()\n\nError in UseMethod(\"xml_find_all\"): no applicable method for 'xml_find_all' applied to an object of class \"function\"\n\n\nStore data in a new dataframe with a column indicating gallery as the source and export as csv.\n\ngallery_packages &lt;- data.frame(package = package_names, stars = github_stars, downloads = downloads_count, gallery = TRUE)\n\nError: object 'package_names' not found\n\nhead(gallery_packages)\n\nError: object 'gallery_packages' not found\n\nwrite_csv(gallery_packages, \"generated_data/gallery_packages.csv\")\n\nError: object 'gallery_packages' not found",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Tidyverse Gallery Scrape</span>"
    ]
  }
]